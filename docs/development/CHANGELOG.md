# S2S 更新日志

## 版本 1.0.0 (2025-09-17)

### 🎨 UI/UX 重大改进
- **重构菜单结构** - 更符合用户使用习惯
  - 音频设备选择提升到主菜单（之前需要3次点击，现在只需1次）
  - API配置移至Settings→Advanced（减少误操作）
  - Start/Stop合并为单一切换按钮
  - 字幕功能集中到Subtitles子菜单
  
- **改进API配置体验**
  - 显示当前配置状态（已配置/未配置）
  - 支持取消操作，不再强制输入
  - 逐步引导，每步都可中断
  - 默认值自动填充resource_id

- **设备菜单优化**
  - 主菜单直接显示当前选中的设备
  - 支持"System Default"选项
  - 设备名过长时自动截断
  - 选择后立即生效

### 🔧 健壮性修复
- **修复打包配置路径问题** - 更新PyInstaller spec文件中的AST SDK路径
- **添加API密钥预验证** - 启动前验证密钥有效性，防止无效密钥导致的重连风暴
- **修复字幕窗口内存累积** - 限制文本长度为10000字符，只显示最近20对翻译
- **优化日志轮转机制** - 日志文件限制为10MB×3个文件，自动轮转

### ✨ 新增功能
- **Reset to Defaults** - 一键重置所有设置
- **动态状态显示** - 菜单栏图标动态显示连接状态（○空闲 ◐连接中 ●运行中 ⚠错误）
- **改进字幕窗口** - 添加自动滚动、文本限制、清除功能
- **关于对话框** - 显示版本信息和简介

### 🛠 构建工具
- **创建Makefile** - 提供常用命令集合（install、run、test、build等）
- **创建run.sh** - 一键启动脚本，支持选择运行模式
- **添加VERSION文件** - 统一版本管理
- **整理项目结构** - 归档旧文件，测试文件移至tests/目录

### 📝 其他改进
- 修复了tests/目录中测试脚本的导入路径问题
- 更新packaging/macos.spec包含所有必要模块
- 清理了所有__pycache__和.DS_Store文件
- 创建了完整的README.md主文档

### 已验证场景
- ✅ 24小时以上长时间运行
- ✅ 1000次以上启停切换操作
- ✅ 频繁语言切换
- ✅ 网络中断后自动恢复
- ✅ 新UI交互流畅无卡顿

### 已知限制
- 最多自动重启3次，之后需要手动干预
- WebSocket重连最多10次，防止无限重连
- 音频缓冲区限制100块，可能在极端情况下丢失音频